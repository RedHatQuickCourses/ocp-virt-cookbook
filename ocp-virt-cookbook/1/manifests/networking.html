<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Networking Manifests :: OpenShift Virtualization cookbook</title>
    <link rel="prev" href="operators.html">
    <link rel="next" href="storage.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">OpenShift Virtualization cookbook</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/ocp-virt-cookbook/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ocp-virt-cookbook" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">OpenShift Virtualization cookbook</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../getting-started/index.html">Getting Started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/prerequisites.html">Prerequisites</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/virtctl-basics.html">Virtctl Basics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/default-storage-class.html">Storage Setup</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../storage/index.html">Storage Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../storage/lvm-operator.html">LVM Operator Installation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../storage/lvm-troubleshooting.html">LVM Troubleshooting</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../networking/index.html">Networking Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../networking/udn-primary-networks.html">UDN Primary Networks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../networking/localnet-secondary.html">Localnet Secondary Networks with CUDN</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../networking/localnet-vlan.html">Localnet Secondary Networks with VLAN using NAD</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../networking/cudn-localnet-vlan.html">Localnet VLAN with CUDN</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../networking/linux-bridges.html">Linux Bridges</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../networking/ovs-bridge-troubleshooting.html">Troubleshooting OVS Bridge Creation for Localnet Networks</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../vm-configuration/index.html">Virtual Machine Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../vm-configuration/cloud-init-ip-configuration.html">Cloud-init IP Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../vm-configuration/cloud-init-troubleshooting.html">Cloud-init Troubleshooting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../vm-configuration/remote-access-linux-vms.html">Remote Access to Linux VMs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../vm-configuration/remote-access-linux-troubleshooting.html">Remote Access to Linux VMs Troubleshooting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../vm-configuration/remote-access-windows-vms.html">Remote Access to Windows VMs via RDP</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../vm-configuration/custom-golden-images.html">Custom Golden Images</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../vm-configuration/golden-images-troubleshooting.html">Golden Images Troubleshooting</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">YAML Manifests Reference</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="operators.html">Operators</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="networking.html">Networking</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="storage.html">Storage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="vms.html">Virtual Machines</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="security.html">Security</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../lab-env/index.html">Lab Environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendix/glossary.html">Glossary</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">OpenShift Virtualization cookbook</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">OpenShift Virtualization cookbook</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">OpenShift Virtualization cookbook</a></li>
    <li><a href="index.html">YAML Manifests Reference</a></li>
    <li><a href="networking.html">Networking</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Networking Manifests</h1>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This page provides Network Attachment Definition (NAD) manifests and network configuration examples for OpenShift Virtualization, organized by network topology type.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_network_topology_types"><a class="anchor" href="#_network_topology_types"></a>Network Topology Types</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OpenShift Virtualization supports several network topologies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Localnet</strong>: Direct access to physical network via OVS bridge</p>
</li>
<li>
<p><strong>Layer2 UDN</strong>: User Defined Networks with Layer 2 connectivity</p>
</li>
<li>
<p><strong>Overlay</strong>: OVN overlay networks (cloud-like networking)</p>
</li>
<li>
<p><strong>Linux Bridges</strong>: Traditional Linux bridge networking</p>
</li>
<li>
<p><strong>Bond Interfaces</strong>: Network interface bonding for redundancy</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_localnet_networks"><a class="anchor" href="#_localnet_networks"></a>Localnet Networks</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Localnet topology provides VMs with direct access to physical network infrastructure through the OVS (Open vSwitch) bridge.</p>
</div>
<div class="sect2">
<h3 id="_localnet_with_vlan_tagging"><a class="anchor" href="#_localnet_with_vlan_tagging"></a>Localnet with VLAN Tagging</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: k8s.cni.cncf.io/v1
kind: NetworkAttachmentDefinition
metadata:
  name: localnet-vlan-100
  namespace: default
spec:
  config: |
    {
      "cniVersion": "0.3.1",
      "name": "localnet-vlan-100",
      "type": "ovn-k8s-cni-overlay",
      "topology": "localnet",
      "netAttachDefName": "default/localnet-vlan-100",
      "vlanID": 100,
      "subnets": "192.168.100.0/24",
      "excludeSubnets": "192.168.100.1/32"
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Purpose:</strong> Connects VMs to physical VLAN 100.</p>
</div>
<div class="paragraph">
<p><strong>Key Fields:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>topology: localnet</code> - Direct physical network access</p>
</li>
<li>
<p><code>vlanID: 100</code> - VLAN tag (must match physical switch configuration)</p>
</li>
<li>
<p><code>subnets</code> - IP range for the network</p>
</li>
<li>
<p><code>excludeSubnets</code> - IPs to exclude (typically gateway)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Prerequisites:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>OVS bridge configured with physnet mapping</p>
</li>
<li>
<p>Physical switch port configured for VLAN trunking</p>
</li>
<li>
<p><a href="../networking/ovs-bridge-troubleshooting.html" class="xref page">Troubleshooting OVS Bridge Creation for Localnet Networks</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_localnet_without_vlan_native"><a class="anchor" href="#_localnet_without_vlan_native"></a>Localnet without VLAN (Native)</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: k8s.cni.cncf.io/v1
kind: NetworkAttachmentDefinition
metadata:
  name: localnet-native
  namespace: default
spec:
  config: |
    {
      "cniVersion": "0.3.1",
      "name": "localnet-native",
      "type": "ovn-k8s-cni-overlay",
      "topology": "localnet",
      "netAttachDefName": "default/localnet-native",
      "subnets": "192.168.1.0/24",
      "excludeSubnets": "192.168.1.1/32"
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>When to use:</strong> When VMs need access to untagged (native) VLAN on physical network.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> No <code>vlanID</code> field means native/untagged VLAN.</p>
</div>
</div>
<div class="sect2">
<h3 id="_localnet_with_static_ipam"><a class="anchor" href="#_localnet_with_static_ipam"></a>Localnet with Static IPAM</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: k8s.cni.cncf.io/v1
kind: NetworkAttachmentDefinition
metadata:
  name: localnet-static-ipam
  namespace: default
spec:
  config: |
    {
      "cniVersion": "0.3.1",
      "name": "localnet-static",
      "type": "ovn-k8s-cni-overlay",
      "topology": "localnet",
      "netAttachDefName": "default/localnet-static-ipam",
      "subnets": "192.168.100.0/24",
      "excludeSubnets": "192.168.100.1-192.168.100.50",
      "ipam": {
        "type": "static"
      }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>When to use:</strong> When VMs use cloud-init for static IP configuration rather than OVN-Kubernetes IPAM.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> Use with cloud-init <code>networkData</code> to configure static IPs.</p>
</div>
</div>
<div class="sect2">
<h3 id="_related_tutorials"><a class="anchor" href="#_related_tutorials"></a>Related Tutorials</h3>
<div class="ulist">
<ul>
<li>
<p><a href="../networking/localnet-secondary.html" class="xref page">Configuring Localnet Secondary Networks with ClusterUserDefinedNetwork in OpenShift Virtualization</a></p>
</li>
<li>
<p><a href="../networking/localnet-vlan.html" class="xref page">Configuring Localnet Secondary Networks with VLAN using NetworkAttachmentDefinition in OpenShift Virtualization</a></p>
</li>
<li>
<p><a href="../networking/ovs-bridge-troubleshooting.html" class="xref page">Troubleshooting OVS Bridge Creation for Localnet Networks</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_user_defined_networks_udn"><a class="anchor" href="#_user_defined_networks_udn"></a>User Defined Networks (UDN)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>UDNs allow creating custom primary networks for VMs, providing Layer 2 connectivity with isolated broadcast domains.</p>
</div>
<div class="sect2">
<h3 id="_layer_2_udn"><a class="anchor" href="#_layer_2_udn"></a>Layer 2 UDN</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: k8s.ovn.org/v1
kind: UserDefinedNetwork
metadata:
  name: vm-layer2-network
  namespace: vm-guests
spec:
  topology: Layer2
  layer2:
    role: Primary
    subnets:
      - "192.168.100.0/24"
    mtu: 1400
    ipamLifecycle: Persistent</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Purpose:</strong> Creates a Layer 2 network for VM primary network attachment.</p>
</div>
<div class="paragraph">
<p><strong>Key Fields:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>topology: Layer2</code> - Layer 2 broadcast domain</p>
</li>
<li>
<p><code>role: Primary</code> - Can be used as VM primary network</p>
</li>
<li>
<p><code>subnets</code> - IP range for the network</p>
</li>
<li>
<p><code>ipamLifecycle: Persistent</code> - IPs persist across VM reboots</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_layer_2_nad_for_udn"><a class="anchor" href="#_layer_2_nad_for_udn"></a>Layer 2 NAD for UDN</h3>
<div class="paragraph">
<p>After creating the UDN, create a NAD to reference it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: k8s.cni.cncf.io/v1
kind: NetworkAttachmentDefinition
metadata:
  name: vm-layer2-nad
  namespace: vm-guests
spec:
  config: |
    {
      "cniVersion": "0.3.1",
      "name": "vm-layer2-network",
      "type": "ovn-k8s-cni-overlay",
      "topology": "layer2",
      "role": "primary",
      "netAttachDefName": "vm-guests/vm-layer2-nad",
      "subnets": "192.168.100.0/24",
      "allowPersistentIPs": true,
      "layer2": {
        "subnets": ["192.168.100.0/24"],
        "joinSubnets": ["192.168.100.0/24"],
        "mtu": 1400
      }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>When to use:</strong> When VMs need custom primary network separate from pod network.</p>
</div>
</div>
<div class="sect2">
<h3 id="_related_tutorials_2"><a class="anchor" href="#_related_tutorials_2"></a>Related Tutorials</h3>
<div class="ulist">
<ul>
<li>
<p><a href="../networking/udn-primary-networks.html" class="xref page">Configuring Layer 2 Primary Networks with UDNs</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_linux_bridges"><a class="anchor" href="#_linux_bridges"></a>Linux Bridges</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Linux bridges provide traditional bridge networking for VMs on a per-node basis.</p>
</div>
<div class="sect2">
<h3 id="_linux_bridge_node_configuration"><a class="anchor" href="#_linux_bridge_node_configuration"></a>Linux Bridge Node Configuration</h3>
<div class="paragraph">
<p>Use NMState to configure Linux bridge on nodes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: nmstate.io/v1
kind: NodeNetworkConfigurationPolicy
metadata:
  name: br-vlan100-policy
spec:
  nodeSelector:
    node-role.kubernetes.io/worker: ""
  desiredState:
    interfaces:
      - name: br-vlan100
        description: Linux bridge for VLAN 100
        type: linux-bridge
        state: up
        ipv4:
          enabled: false
        bridge:
          options:
            stp:
              enabled: false
          port:
            - name: ens224
              vlan:
                mode: access
                tag: 100</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Purpose:</strong> Creates Linux bridge attached to physical interface with VLAN 100.</p>
</div>
<div class="paragraph">
<p><strong>Customization:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name: br-vlan100</code> - Bridge name</p>
</li>
<li>
<p><code>name: ens224</code> - Physical interface (update to your interface)</p>
</li>
<li>
<p><code>tag: 100</code> - VLAN tag</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_linux_bridge_nad"><a class="anchor" href="#_linux_bridge_nad"></a>Linux Bridge NAD</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: k8s.cni.cncf.io/v1
kind: NetworkAttachmentDefinition
metadata:
  name: bridge-vlan100
  namespace: default
spec:
  config: |
    {
      "cniVersion": "0.3.1",
      "name": "bridge-vlan100",
      "type": "cnv-bridge",
      "bridge": "br-vlan100",
      "macspoofchk": true,
      "ipam": {}
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Purpose:</strong> NAD that references the Linux bridge for VM attachment.</p>
</div>
<div class="paragraph">
<p><strong>When to use:</strong> When per-node isolation is acceptable and OVS is not available.</p>
</div>
</div>
<div class="sect2">
<h3 id="_related_tutorials_3"><a class="anchor" href="#_related_tutorials_3"></a>Related Tutorials</h3>
<div class="ulist">
<ul>
<li>
<p><a href="../networking/linux-bridges.html" class="xref page">Adding a Bridge as a Secondary Network Adapter</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overlay_networks"><a class="anchor" href="#_overlay_networks"></a>Overlay Networks</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OVN overlay networks provide cloud-like networking with automatic IPAM.</p>
</div>
<div class="sect2">
<h3 id="_overlay_network_with_dhcp"><a class="anchor" href="#_overlay_network_with_dhcp"></a>Overlay Network with DHCP</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: k8s.cni.cncf.io/v1
kind: NetworkAttachmentDefinition
metadata:
  name: overlay-dhcp
  namespace: default
spec:
  config: |
    {
      "cniVersion": "0.3.1",
      "name": "overlay-dhcp",
      "type": "ovn-k8s-cni-overlay",
      "topology": "layer2",
      "subnets": "10.200.0.0/16",
      "mtu": 1400,
      "netAttachDefName": "default/overlay-dhcp",
      "ipam": {
        "type": "ovn-k8s-cni-ipam",
        "provider": "ovn-kubernetes"
      }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Purpose:</strong> Creates isolated overlay network with OVN-Kubernetes IPAM.</p>
</div>
<div class="paragraph">
<p><strong>When to use:</strong> For cloud-like isolated networks without physical network dependencies.</p>
</div>
<div class="paragraph">
<p><strong>Benefits:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>No physical network configuration required</p>
</li>
<li>
<p>Automatic IPAM</p>
</li>
<li>
<p>Network isolation</p>
</li>
<li>
<p>Portable across nodes</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bond_interfaces"><a class="anchor" href="#_bond_interfaces"></a>Bond Interfaces</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Network bonding provides redundancy and increased bandwidth.</p>
</div>
<div class="sect2">
<h3 id="_bond_interface_configuration"><a class="anchor" href="#_bond_interface_configuration"></a>Bond Interface Configuration</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: nmstate.io/v1
kind: NodeNetworkConfigurationPolicy
metadata:
  name: bond-config
spec:
  nodeSelector:
    node-role.kubernetes.io/worker: ""
  desiredState:
    interfaces:
      - name: bond0
        description: Active-backup bond
        type: bond
        state: up
        ipv4:
          enabled: false
        link-aggregation:
          mode: active-backup
          options:
            miimon: "100"
          port:
            - ens224
            - ens256</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Purpose:</strong> Creates active-backup bond interface for redundancy.</p>
</div>
<div class="paragraph">
<p><strong>Bond Modes:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>active-backup</code> - One active, others standby</p>
</li>
<li>
<p><code>802.3ad</code> - LACP (requires switch support)</p>
</li>
<li>
<p><code>balance-rr</code> - Round-robin</p>
</li>
<li>
<p><code>balance-xor</code> - XOR hash-based</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cluster_network_physical_mapping"><a class="anchor" href="#_cluster_network_physical_mapping"></a>Cluster Network Physical Mapping</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For localnet topology, map logical network names to physical bridges:</p>
</div>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># This is typically configured via NMState NNCP
# See operators manifest for OVS bridge mapping example
oc get nncp ovs-br-mapping -o yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>The mapping defines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Logical network name</strong> (e.g., <code>physnet1</code>) - Used in NAD configurations</p>
</li>
<li>
<p><strong>Physical bridge</strong> (e.g., <code>br-ex</code>) - OVS bridge name on nodes</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_network_verification"><a class="anchor" href="#_network_verification"></a>Network Verification</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_verify_nads"><a class="anchor" href="#_verify_nads"></a>Verify NADs</h3>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># List all NADs
oc get network-attachment-definition -A

# Describe specific NAD
oc describe network-attachment-definition &lt;nad-name&gt; -n &lt;namespace&gt;

# Check NAD in VM
oc get vmi &lt;vm-name&gt; -n &lt;namespace&gt; -o jsonpath='{.spec.networks[*]}'</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_verify_ovs_configuration"><a class="anchor" href="#_verify_ovs_configuration"></a>Verify OVS Configuration</h3>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Check OVS bridge mapping on node
oc debug node/&lt;node-name&gt;
chroot /host
ovs-vsctl show
ovs-vsctl get Open_vSwitch . external_ids:ovn-bridge-mappings</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_test_network_connectivity"><a class="anchor" href="#_test_network_connectivity"></a>Test Network Connectivity</h3>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Get VM IP
oc get vmi &lt;vm-name&gt; -n &lt;namespace&gt; -o jsonpath='{.status.interfaces[*].ipAddress}'

# Test from another VM or pod
ping &lt;vm-ip&gt;

# Inside VM console
virtctl console &lt;vm-name&gt; -n &lt;namespace&gt;
ip addr show
ip route show</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_common_network_patterns"><a class="anchor" href="#_common_network_patterns"></a>Common Network Patterns</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_single_network_pod_network_only"><a class="anchor" href="#_single_network_pod_network_only"></a>Single Network (Pod Network Only)</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  template:
    spec:
      networks:
        - name: default
          pod: {}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Use case:</strong> Simple VMs, development, testing.</p>
</div>
</div>
<div class="sect2">
<h3 id="_dual_network_pod_secondary"><a class="anchor" href="#_dual_network_pod_secondary"></a>Dual Network (Pod + Secondary)</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  template:
    spec:
      networks:
        - name: default
          pod: {}
        - name: vlan-network
          multus:
            networkName: localnet-vlan-100</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Use case:</strong> Production VMs with management (pod) and data (VLAN) networks.</p>
</div>
</div>
<div class="sect2">
<h3 id="_multiple_networks"><a class="anchor" href="#_multiple_networks"></a>Multiple Networks</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  template:
    spec:
      networks:
        - name: default
          pod: {}
        - name: data-network
          multus:
            networkName: localnet-vlan-100
        - name: storage-network
          multus:
            networkName: localnet-vlan-200</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Use case:</strong> Complex deployments with network segmentation.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_troubleshooting"><a class="anchor" href="#_troubleshooting"></a>Troubleshooting</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_nad_not_found"><a class="anchor" href="#_nad_not_found"></a>NAD Not Found</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">Error: NAD "localnet-vlan-100" not found in namespace "default"</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Solution:</strong> Create NAD in same namespace as VM or use <code>namespace/nad-name</code> format.</p>
</div>
</div>
<div class="sect2">
<h3 id="_no_connectivity_on_secondary_network"><a class="anchor" href="#_no_connectivity_on_secondary_network"></a>No Connectivity on Secondary Network</h3>
<div class="paragraph">
<p><strong>Check:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>NAD exists: <code>oc get nad -n &lt;namespace&gt;</code></p>
</li>
<li>
<p>OVS bridge configured: <code>oc get nncp</code></p>
</li>
<li>
<p>Physical switch configured for VLAN</p>
</li>
<li>
<p>Cloud-init network configuration correct</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_vm_interface_not_getting_ip"><a class="anchor" href="#_vm_interface_not_getting_ip"></a>VM Interface Not Getting IP</h3>
<div class="paragraph">
<p><strong>Check:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>IPAM configuration in NAD</p>
</li>
<li>
<p>Cloud-init logs: <code>/var/log/cloud-init.log</code></p>
</li>
<li>
<p>Interface status: <code>ip addr show</code></p>
</li>
<li>
<p>DHCP client running: <code>nmcli device status</code></p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_summary"><a class="anchor" href="#_summary"></a>Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Key network manifest types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Localnet NADs</strong>: Direct physical network access</p>
</li>
<li>
<p><strong>UDN</strong>: Custom primary networks for VMs</p>
</li>
<li>
<p><strong>Linux Bridge NADs</strong>: Traditional bridge networking</p>
</li>
<li>
<p><strong>Overlay NADs</strong>: Cloud-like isolated networks</p>
</li>
<li>
<p><strong>Bond configurations</strong>: Network redundancy</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see_also"><a class="anchor" href="#_see_also"></a>See Also</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="../networking/index.html" class="xref page">Networking Configuration</a></p>
</li>
<li>
<p><a href="operators.html" class="xref page">NMState Operator Configuration</a></p>
</li>
<li>
<p><a href="index.html" class="xref page">YAML Manifests Reference</a></p>
</li>
</ul>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="operators.html">Operators</a></span>
  <span class="next"><a href="storage.html">Storage</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
